!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("chart.js")):"function"==typeof define&&define.amd?define(["exports","chart.js"],e):e((t=t||self).ChartGraphs={},t.Chart)}(this,function(t,e){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(n,!0).forEach(function(e){r(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}e.defaults.global.elements.edgeLine=a({},e.defaults.global.elements.line,{},{});var o=e.elements.EdgeLine=e.elements.Line.extend({draw:function(){var t=this._view,n=this._chart.ctx,r=e.defaults.global,i=r.elements.line;n.save(),n.lineCap=t.borderCapStyle||i.borderCapStyle,n.setLineDash&&n.setLineDash(t.borderDash||i.borderDash),n.lineDashOffset=e.helpers.valueOrDefault(t.borderDashOffset,i.borderDashOffset),n.lineJoin=t.borderJoinStyle||i.borderJoinStyle,n.lineWidth=e.helpers.valueOrDefault(t.borderWidth,i.borderWidth),n.strokeStyle=t.borderColor||r.defaultColor,n.beginPath();var a=this._from._view,o=this._to._view,s=Math.hypot(o.x-a.x,o.y-a.y)*t.tension,u={horizontal:{fx:(o.x-a.x)*t.tension,fy:0,tx:(a.x-o.x)*t.tension,ty:0},vertical:{fx:0,fy:(o.y-a.y)*t.tension,tx:0,ty:(a.y-o.y)*t.tension},radial:{fx:isNaN(a.angle)?0:Math.cos(a.angle)*s,fy:isNaN(a.angle)?0:Math.sin(a.angle)*-s,tx:isNaN(o.angle)?0:Math.cos(o.angle)*-s,ty:isNaN(o.angle)?0:Math.sin(o.angle)*s}},l=u[this._orientation]||u.horizontal,h={x:a.x,y:a.y,tension:t.tension,steppedLine:a.steppedLine,controlPointPreviousX:a.x+l.fx,controlPointPreviousY:a.y+l.fy},c={x:o.x,y:o.y,tension:t.tension,steppedLine:o.steppedLine,controlPointNextX:o.x+l.tx,controlPointNextY:o.y+l.ty};n.moveTo(o.x,o.y),e.helpers.canvas.lineTo(n,c,h),n.stroke(),n.restore()}}),s=["push","pop","shift","splice","unshift"];function u(t,e){var n=t._chartjs;if(n){var r=n.listeners,i=r.indexOf(e);-1!==i&&r.splice(i,1),r.length>0||(s.forEach(function(e){delete t[e]}),delete t._chartjs)}}e.defaults.graph=e.helpers.configMerge(e.defaults.scatter,{layout:{padding:5},scales:{xAxes:[{display:!1}],yAxes:[{display:!1}]},tooltips:{callbacks:{label:function(t,e){return e.labels[t.index]}}}}),e.defaults.global.datasets&&e.defaults.global.datasets.scatter&&(e.defaults.global.datasets.graph=a({},e.defaults.global.datasets.scatter));var l=e.controllers.scatter.prototype,h=e.controllers.graph=e.controllers.scatter.extend({dataElementType:e.elements.Point,edgeElementType:e.elements.EdgeLine,initialize:function(t,e){var n=this;this._initialReset=!0,this._edgeListener={onDataPush:function(){var t=arguments.length;n.insertEdgeElements(n.getDataset().edges.length-t,t)},onDataPop:function(){n.getMeta().edges.pop(),n.resyncLayout()},onDataShift:function(){n.getMeta().edges.shift(),n.resyncLayout()},onDataSplice:function(t,e){n.getMeta().edges.splice(t,e),n.insertEdgeElements(t,arguments.length<=2?0:arguments.length-2)},onDataUnshift:function(){n.insertEdgeElements(0,arguments.length)}},l.initialize.call(this,t,e)},createEdgeMetaData:function(t){return this.edgeElementType&&new this.edgeElementType({_chart:this.chart,_datasetIndex:this.index,_index:t})},update:function(t){var e=this;l.update.call(this,t);var n=this.getMeta().edges||[];n.forEach(function(n,r){return e.updateEdgeElement(n,r,t)}),n.forEach(function(t){return t.pivot()})},destroy:function(){l.destroy.call(this),this._edges&&u(this._edges,this._edgeListener),this.stopLayout()},updateElement:function(t,e,n){if(l.updateElement.call(this,t,e,n),n){var r=this.getScaleForId(this.getMeta().xAxisID);t._model.x=r.getBasePixel()}},updateEdgeElement:function(t,e){var n=this.getDataset().edges[e],r=this.getMeta(),i=r.data;t._from=this.resolveNode(i,n.source),t._to=this.resolveNode(i,n.target),t._xScale=this.getScaleForId(r.xAxisID),t._scale=t._yScale=this.getScaleForId(r.yAxisID),t._datasetIndex=this.index,t._model=this._resolveEdgeLineOptions(t,e)},_resolveEdgeLineOptions:function(t,n){for(var r=this.chart,i=r.data.datasets[this.index],a=t.custom||{},o=r.options.elements.line,s={chart:r,edgeIndex:n,dataset:i,datasetIndex:this.index},u=["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill","cubicInterpolationMode"],l={},h=0;h<u.length;++h){var c=u[h];l[c]=e.helpers.options.resolve([a[c],i[c],o[c]],s,n)}return l},resolveNode:function(t,e){if("number"==typeof e)return t[e];if("string"==typeof e)return t[this.chart.data.labels.indexOf(e)];if(t.indexOf(e)>=0)return e;if(e&&"number"==typeof e.index)return t[e.index];var n=this.getDataset().data.indexOf(e);return n>=0?t[n]:(console.warn("cannot resolve edge ref",e),null)},buildOrUpdateElements:function(){var t,e,n=this.getDataset().edges||[];this._edges!==n&&(this._edges&&u(this._edges,this._edgeListener),n&&Object.isExtensible(n)&&(t=n,e=this._edgeListener,t._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),s.forEach(function(e){var n="onData"+e.charAt(0).toUpperCase()+e.slice(1),r=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:function(){var e=Array.prototype.slice.call(arguments),i=r.apply(this,e);return t._chartjs.listeners.forEach(function(t){"function"==typeof t[n]&&t[n].apply(t,e)}),i}})}))),this._edges=n),l.buildOrUpdateElements.call(this)},transition:function(t){l.transition.call(this,t),(this.getMeta().edges||[]).forEach(function(e){return e.transition(t)})},draw:function(){var t=this.getMeta().edges||[],n=this.chart.chartArea;t.length>0&&(e.helpers.canvas.clipArea(this.chart.ctx,{left:n.left,right:n.right,top:n.top,bottom:n.bottom}),t.forEach(function(t){return t.draw()}),e.helpers.canvas.unclipArea(this.chart.ctx)),l.draw.call(this)},reset:function(){this._initialReset?this._initialReset=!1:this.resetLayout(),l.reset.call(this)},resyncElements:function(){l.resyncElements.call(this);var t=this.getDataset();this._deriveEdges();var e=this.getMeta(),n=t.edges||[],r=e.edges||(e.edges=[]),i=r.length,a=n.length;a<i?(r.splice(a,i-a),this.resyncLayout()):a>i&&this.insertEdgeElements(i,a-i)},getTreeRoot:function(){var t=this.getDataset(),e=t.data;if(t.derivedEdges)return e.find(function(t){return null==t.parent});var n=t.edges||[],r=new Set;n.forEach(function(t){r.add(t.source),r.add(t.target)});var i=this.chart.data.labels;return e.find(function(t,e){return!r.has(t)&&r.has(i[e])})},getTreeChildren:function(t){var e=this,n=this.getDataset(),r=n.data;return n.edges.filter(function(n){return n.source=e.resolveNode(r,n.source),n.source===t}).map(function(t){return t.target=e.resolveNode(r,t.target),t.target})},_deriveEdges:function(){var t=this,e=this.getDataset();if(!e.derivedEdges)return e.edges;var n=[];return e.derivedEdges=!0,e.data.forEach(function(t,e){t.index=e}),e.data.forEach(function(r){if(null!=r.parent){var i=t.resolveNode(e.data,r.parent);n.push({source:i,target:r})}}),e.edges=n,n},addElements:function(){l.addElements.call(this);var t=this.getMeta(),e=this.getDataset();e.edges||(e.derivedEdges=!0,this._deriveEdges());for(var n=e.edges,r=t.edges||(t.edges=[]),i=0;i<n.length;++i)r[i]=r[i]||this.createEdgeMetaData(i);this.resyncLayout()},addEdgeElementAndReset:function(t){var e=this.createEdgeMetaData(t);this.getMeta().edges.splice(t,0,e),this.updateEdgeElement(e,t,!0)},insertEdgeElements:function(t,e){for(var n=0;n<e;++n)this.addEdgeElementAndReset(t+n);this.resyncLayout()},onDataPush:function(){this._deriveEdges(),l.onDataPush.apply(this,Array.from(arguments)),this.resyncLayout()},onDataPop:function(){this._deriveEdges(),l.onDataPop.call(this),this.resyncLayout()},onDataShift:function(){this._deriveEdges(),l.onDataShift.call(this),this.resyncLayout()},onDataSplice:function(){this._deriveEdges(),l.onDataSplice.apply(this,Array.from(arguments)),this.resyncLayout()},onDataUnshift:function(){this._deriveEdges(),l.onDataUnshift.apply(this,Array.from(arguments)),this.resyncLayout()},reLayout:function(){},resetLayout:function(){},stopLayout:function(){},resyncLayout:function(){}});function c(t,e){var n;function r(){var r,i,a=n.length,o=0,s=0;for(r=0;r<a;++r)o+=(i=n[r]).x,s+=i.y;for(o=o/a-t,s=s/a-e,r=0;r<a;++r)(i=n[r]).x-=o,i.y-=s}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r}function f(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,u,l,h,c,f,d=t._root,p={data:r},y=t._x0,g=t._y0,v=t._x1,x=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((l=e>=(a=(y+v)/2))?y=a:v=a,(h=n>=(o=(g+x)/2))?g=o:x=o,i=d,!(d=d[c=h<<1|l]))return i[c]=p,t;if(s=+t._x.call(null,d.data),u=+t._y.call(null,d.data),e===s&&n===u)return p.next=d,i?i[c]=p:t._root=p,t;do{i=i?i[c]=new Array(4):t._root=new Array(4),(l=e>=(a=(y+v)/2))?y=a:v=a,(h=n>=(o=(g+x)/2))?g=o:x=o}while((c=h<<1|l)==(f=(u>=o)<<1|s>=a));return i[f]=d,i[c]=p,t}function d(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function p(t){return t[0]}function y(t){return t[1]}function g(t,e,n){var r=new v(null==e?p:e,null==n?y:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function v(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function x(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}e.prototype.relayout=function(){for(var t=this.data.datasets.length,e=0;e<t;++e){var n=this.getDatasetMeta(e);"function"==typeof n.controller.reLayout&&n.controller.reLayout()}};var _=g.prototype=v.prototype;function m(t){return function(){return t}}function w(){return 1e-6*(Math.random()-.5)}function b(t){return t.x+t.vx}function E(t){return t.y+t.vy}function D(t){var e,n,r=1,i=1;function a(){for(var t,a,s,u,l,h,c,f=e.length,d=0;d<i;++d)for(a=g(e,b,E).visitAfter(o),t=0;t<f;++t)s=e[t],h=n[s.index],c=h*h,u=s.x+s.vx,l=s.y+s.vy,a.visit(p);function p(t,e,n,i,a){var o=t.data,f=t.r,d=h+f;if(!o)return e>u+d||i<u-d||n>l+d||a<l-d;if(o.index>s.index){var p=u-o.x-o.vx,y=l-o.y-o.vy,g=p*p+y*y;g<d*d&&(0===p&&(g+=(p=w())*p),0===y&&(g+=(y=w())*y),g=(d-(g=Math.sqrt(g)))/g*r,s.vx+=(p*=g)*(d=(f*=f)/(c+f)),s.vy+=(y*=g)*d,o.vx-=p*(d=1-d),o.vy-=y*d)}}}function o(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function s(){if(e){var r,i,a=e.length;for(n=new Array(a),r=0;r<a;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=m(null==t?1:+t)),a.initialize=function(t){e=t,s()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(r=+t,a):r},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:m(+e),s(),a):t},a}function N(t){return t.index}function A(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function M(t){var e,r,i,a,o,s=N,u=function(t){return 1/Math.min(a[t.source.index],a[t.target.index])},l=m(30),h=1;function c(n){for(var i=0,a=t.length;i<h;++i)for(var s,u,l,c,f,d,p,y=0;y<a;++y)u=(s=t[y]).source,c=(l=s.target).x+l.vx-u.x-u.vx||w(),f=l.y+l.vy-u.y-u.vy||w(),c*=d=((d=Math.sqrt(c*c+f*f))-r[y])/d*n*e[y],f*=d,l.vx-=c*(p=o[y]),l.vy-=f*p,u.vx+=c*(p=1-p),u.vy+=f*p}function f(){if(i){var u,l,h=i.length,c=t.length,f=new Map(i.map(function(t,e){return[s(t,e,i),t]}));for(u=0,a=new Array(h);u<c;++u)(l=t[u]).index=u,"object"!==n(l.source)&&(l.source=A(f,l.source)),"object"!==n(l.target)&&(l.target=A(f,l.target)),a[l.source.index]=(a[l.source.index]||0)+1,a[l.target.index]=(a[l.target.index]||0)+1;for(u=0,o=new Array(c);u<c;++u)l=t[u],o[u]=a[l.source.index]/(a[l.source.index]+a[l.target.index]);e=new Array(c),d(),r=new Array(c),p()}}function d(){if(i)for(var n=0,r=t.length;n<r;++n)e[n]=+u(t[n],n,t)}function p(){if(i)for(var e=0,n=t.length;e<n;++e)r[e]=+l(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t){i=t,f()},c.links=function(e){return arguments.length?(t=e,f(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:m(+t),d(),c):u},c.distance=function(t){return arguments.length?(l="function"==typeof t?t:m(+t),p(),c):l},c}_.copy=function(){var t,e,n=new v(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=x(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=x(e));return n},_.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return f(this.cover(e,n),e,n,t)},_.addAll=function(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),u=1/0,l=1/0,h=-1/0,c=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<u&&(u=r),r>h&&(h=r),i<l&&(l=i),i>c&&(c=i));if(u>h||l>c)return this;for(this.cover(u,l).cover(h,c),n=0;n<a;++n)f(this,o[n],s[n],t[n]);return this},_.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o,s,u=i-n,l=this._root;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=l,l=o,u*=2,s){case 0:i=n+u,a=r+u;break;case 1:n=i-u,a=r+u;break;case 2:i=n+u,r=a-u;break;case 3:n=i-u,r=a-u}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},_.data=function(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},_.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},_.find=function(t,e,n){var r,i,a,o,s,u,l,h=this._x0,c=this._y0,f=this._x1,p=this._y1,y=[],g=this._root;for(g&&y.push(new d(g,h,c,f,p)),null==n?n=1/0:(h=t-n,c=e-n,f=t+n,p=e+n,n*=n);u=y.pop();)if(!(!(g=u.node)||(i=u.x0)>f||(a=u.y0)>p||(o=u.x1)<h||(s=u.y1)<c))if(g.length){var v=(i+o)/2,x=(a+s)/2;y.push(new d(g[3],v,x,o,s),new d(g[2],i,x,v,s),new d(g[1],v,a,o,x),new d(g[0],i,a,v,x)),(l=(e>=x)<<1|t>=v)&&(u=y[y.length-1],y[y.length-1]=y[y.length-1-l],y[y.length-1-l]=u)}else{var _=t-+this._x.call(null,g.data),m=e-+this._y.call(null,g.data),w=_*_+m*m;if(w<n){var b=Math.sqrt(n=w);h=t-b,c=e-b,f=t+b,p=e+b,r=g.data}}return r},_.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,u,l,h,c,f,d=this._root,p=this._x0,y=this._y0,g=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((l=a>=(s=(p+g)/2))?p=s:g=s,(h=o>=(u=(y+v)/2))?y=u:v=u,e=d,!(d=d[c=h<<1|l]))return this;if(!d.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(n=e,f=c)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[c]=i:delete e[c],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=i,this)},_.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},_.root=function(){return this._root},_.size=function(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},_.visit=function(t){var e,n,r,i,a,o,s=[],u=this._root;for(u&&s.push(new d(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&u.length){var l=(r+a)/2,h=(i+o)/2;(n=u[3])&&s.push(new d(n,l,h,a,o)),(n=u[2])&&s.push(new d(n,r,h,l,o)),(n=u[1])&&s.push(new d(n,l,i,a,h)),(n=u[0])&&s.push(new d(n,r,i,l,h))}return this},_.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new d(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,u=e.x1,l=e.y1,h=(o+u)/2,c=(s+l)/2;(a=i[0])&&n.push(new d(a,o,s,h,c)),(a=i[1])&&n.push(new d(a,h,s,u,c)),(a=i[2])&&n.push(new d(a,o,c,h,l)),(a=i[3])&&n.push(new d(a,h,c,u,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},_.x=function(t){return arguments.length?(this._x=t,this):this._x},_.y=function(t){return arguments.length?(this._y=t,this):this._y};var L={value:function(){}};function O(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new z(r)}function z(t){this._=t}function P(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function j(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=L,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}z.prototype=O.prototype={constructor:z,on:function(t,e){var n,r,i=this._,a=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=a[o]).type)i[n]=j(i[n],t.name,e);else if(null==e)for(n in i)i[n]=j(i[n],t.name,null);return this}for(;++o<s;)if((n=(t=a[o]).type)&&(n=P(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new z(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var k,S,T=0,q=0,I=0,C=1e3,B=0,R=0,F=0,G="object"===("undefined"==typeof performance?"undefined":n(performance))&&performance.now?performance:Date,U="object"===("undefined"==typeof window?"undefined":n(window))&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function J(){return R||(U(W),R=G.now()+F)}function W(){R=0}function X(){this._call=this._time=this._next=null}function Y(t,e,n){var r=new X;return r.restart(t,e,n),r}function H(){R=(B=G.now())+F,T=q=0;try{!function(){J(),++T;for(var t,e=k;e;)(t=R-e._time)>=0&&e._call.call(null,t),e=e._next;--T}()}finally{T=0,function(){var t,e,n=k,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:k=e);S=t,Q(r)}(),R=0}}function K(){var t=G.now(),e=t-B;e>C&&(F-=e,B=t)}function Q(t){T||(q&&(q=clearTimeout(q)),t-R>24?(t<1/0&&(q=setTimeout(H,t-G.now()-F)),I&&(I=clearInterval(I))):(I||(B=G.now(),I=setInterval(K,C)),T=1,U(H)))}function V(t){return t.x}function Z(t){return t.y}X.prototype=Y.prototype={constructor:X,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?J():+n)+(null==e?0:+e),this._next||S===this||(S?S._next=this:k=this,S=this),this._call=t,this._time=n,Q()},stop:function(){this._call&&(this._call=null,this._time=1/0,Q())}};var $=10,tt=Math.PI*(3-Math.sqrt(5));function et(){var t,e,n,r,i=m(-30),a=1,o=1/0,s=.81;function u(r){var i,a=t.length,o=g(t,V,Z).visitAfter(h);for(n=r,i=0;i<a;++i)e=t[i],o.visit(c)}function l(){if(t){var e,n,a=t.length;for(r=new Array(a),e=0;e<a;++e)n=t[e],r[n.index]=+i(n,e,t)}}function h(t){var e,n,i,a,o,s=0,u=0;if(t.length){for(i=a=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,u+=n,i+=n*e.x,a+=n*e.y);t.x=i/u,t.y=a/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=r[e.data.index]}while(e=e.next)}t.value=s}function c(t,i,u,l){if(!t.value)return!0;var h=t.x-e.x,c=t.y-e.y,f=l-i,d=h*h+c*c;if(f*f/s<d)return d<o&&(0===h&&(d+=(h=w())*h),0===c&&(d+=(c=w())*c),d<a&&(d=Math.sqrt(a*d)),e.vx+=h*t.value*n/d,e.vy+=c*t.value*n/d),!0;if(!(t.length||d>=o)){(t.data!==e||t.next)&&(0===h&&(d+=(h=w())*h),0===c&&(d+=(c=w())*c),d<a&&(d=Math.sqrt(a*d)));do{t.data!==e&&(f=r[t.data.index]*n/d,e.vx+=h*f,e.vy+=c*f)}while(t=t.next)}}return u.initialize=function(e){t=e,l()},u.strength=function(t){return arguments.length?(i="function"==typeof t?t:m(+t),l(),u):i},u.distanceMin=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.distanceMax=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.theta=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u}function nt(t,e,n){var r,i,a,o=m(.1);function s(t){for(var o=0,s=r.length;o<s;++o){var u=r[o],l=u.x-e||1e-6,h=u.y-n||1e-6,c=Math.sqrt(l*l+h*h),f=(a[o]-c)*i[o]*t/c;u.vx+=l*f,u.vy+=h*f}}function u(){if(r){var e,n=r.length;for(i=new Array(n),a=new Array(n),e=0;e<n;++e)a[e]=+t(r[e],e,r),i[e]=isNaN(a[e])?0:+o(r[e],e,r)}}return"function"!=typeof t&&(t=m(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){r=t,u()},s.strength=function(t){return arguments.length?(o="function"==typeof t?t:m(+t),u(),s):o},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:m(+e),u(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s}function rt(t){var e,n,r,i=m(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vx+=(r[a]-i.x)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=m(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:m(+t),o(),a):i},a.x=function(e){return arguments.length?(t="function"==typeof e?e:m(+e),o(),a):t},a}function it(t){var e,n,r,i=m(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vy+=(r[a]-i.y)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=m(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:m(+t),o(),a):i},a.y=function(e){return arguments.length?(t="function"==typeof e?e:m(+e),o(),a):t},a}e.defaults.forceDirectedGraph=e.helpers.configMerge(e.defaults.graph,{simulation:{autoRestart:!0,forces:{center:!0,collide:!1,link:!0,manyBody:!0,x:!1,y:!1,radial:!1}}}),e.defaults.global.datasets&&e.defaults.global.datasets.graph&&(e.defaults.global.datasets.forceDirectedGraph=a({},e.defaults.global.datasets.graph));var at=h.prototype,ot=e.controllers.forceDirectedGraph=h.extend({initialize:function(t,e){var n=this;this._simulation=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,u=Y(h),l=O("tick","end");function h(){c(),l.call("tick",e),n<r&&(u.stop(),l.call("end",e))}function c(r){var u,l,h=t.length;void 0===r&&(r=1);for(var c=0;c<r;++c)for(n+=(a-n)*i,s.forEach(function(t){t(n)}),u=0;u<h;++u)null==(l=t[u]).fx?l.x+=l.vx*=o:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=o:(l.y=l.fy,l.vy=0);return e}function f(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=$*Math.sqrt(n),a=n*tt;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function d(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),f(),e={tick:c,restart:function(){return u.restart(h),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.forEach(d),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(a=+t,e):a},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,d(n)),e):s.get(t)},find:function(e,n,r){var i,a,o,s,u,l=0,h=t.length;for(null==r?r=1/0:r*=r,l=0;l<h;++l)(o=(i=e-(s=t[l]).x)*i+(a=n-s.y)*a)<r&&(u=s,r=o);return u},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}}().on("tick",function(){n.chart.update()}).on("end",function(){n.chart.update()});var r=t.options.simulation,i={center:c,collide:D,link:M,manyBody:et,x:rt,y:it,radial:nt};Object.keys(i).forEach(function(t){var e=r.forces[t];if(e){var a=i[t]();"boolean"!=typeof e&&Object.keys(e).forEach(function(t){a[t](e[t])}),n._simulation.force(t,a)}}),this._simulation.stop(),at.initialize.call(this,t,e)},resetLayout:function(){at.resetLayout.call(this),this._simulation.stop();var t=this.getDataset().data;t.forEach(function(t){t.reset&&(delete t.x,delete t.y,delete t.vx,delete t.vy)}),this._simulation.nodes(t),this._simulation.alpha(1).restart()},resyncLayout:function(){at.resyncLayout.call(this),this._simulation.stop();var t=this.getDataset(),e=t.data;e.forEach(function(t){null==t.x&&null==t.y&&(t.reset=!0)});var n=this._simulation.force("link");n&&n.links([]),this._simulation.nodes(e),n&&n.links(t.edges||[]),this.chart.options.simulation.autoRestart&&this._simulation.alpha(1).restart()},reLayout:function(){this._simulation.alpha(1).restart()},stopLayout:function(){at.stopLayout.call(this),this._simulation.stop()}});function st(t,e){return t.parent===e.parent?1:2}function ut(t,e){return t+e.x}function lt(t,e){return Math.max(t,e.y)}function ht(){var t=st,e=1,n=1,r=!1;function i(i){var a,o=0;i.eachAfter(function(e){var n=e.children;n?(e.x=function(t){return t.reduce(ut,0)/t.length}(n),e.y=function(t){return 1+t.reduce(lt,0)}(n)):(e.x=a?o+=t(e,a):0,e.y=0,a=e)});var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),u=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),l=s.x-t(s,u)/2,h=u.x+t(u,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-l)/(h-l)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}function ct(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function ft(t,e){var n,r,i,a,o,s=new gt(t),u=+t.value&&(s.value=t.value),l=[s];for(null==e&&(e=dt);n=l.pop();)if(u&&(n.value=+n.data.value),(i=e(n.data))&&(o=i.length))for(n.children=new Array(o),a=o-1;a>=0;--a)l.push(r=n.children[a]=new gt(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(yt)}function dt(t){return t.children}function pt(t){t.data=t.data.data}function yt(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function gt(t){this.data=t,this.depth=this.height=0,this.parent=null}function vt(t,e){return t.parent===e.parent?1:2}function xt(t){var e=t.children;return e?e[0]:t.t}function _t(t){var e=t.children;return e?e[e.length-1]:t.t}function mt(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function wt(t,e,n){return t.a.parent===e.parent?t.a:n}function bt(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function Et(){var t=vt,e=1,n=1,r=null;function i(i){var u=function(t){for(var e,n,r,i,a,o=new bt(t,0),s=[o];e=s.pop();)if(r=e._.children)for(e.children=new Array(a=r.length),i=a-1;i>=0;--i)s.push(n=e.children[i]=new bt(r[i],i)),n.parent=e;return(o.parent=new bt(null,0)).children=[o],o}(i);if(u.eachAfter(a),u.parent.m=-u.z,u.eachBefore(o),r)i.eachBefore(s);else{var l=i,h=i,c=i;i.eachBefore(function(t){t.x<l.x&&(l=t),t.x>h.x&&(h=t),t.depth>c.depth&&(c=t)});var f=l===h?1:t(l,h)/2,d=f-l.x,p=e/(h.x+f+d),y=n/(c.depth||1);i.eachBefore(function(t){t.x=(t.x+d)*p,t.y=t.depth*y})}return i}function a(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,a=i.length;--a>=0;)(e=i[a]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var a=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-a):e.z=a}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,a=e,o=e,s=n,u=a.parent.children[0],l=a.m,h=o.m,c=s.m,f=u.m;s=_t(s),a=xt(a),s&&a;)u=xt(u),(o=_t(o)).a=e,(i=s.z+c-a.z-l+t(s._,a._))>0&&(mt(wt(s,e,r),e,i),l+=i,h+=i),c+=s.m,l+=a.m,f+=u.m,h+=o.m;s&&!_t(o)&&(o.t=s,o.m+=c-h),a&&!xt(u)&&(u.t=a,u.m+=l-f,r=e)}return r}(e,i,e.parent.A||r[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}gt.prototype=ft.prototype={constructor:gt,count:function(){return this.eachAfter(ct)},each:function(t){var e,n,r,i,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},eachAfter:function(t){for(var e,n,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each(function(e){t.push(e)}),t},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return ft(this).eachBefore(pt)}},bt.prototype=Object.create(gt.prototype);e.defaults.dendogram=e.helpers.configMerge(e.defaults.graph,{tree:{mode:"dendogram",lineTension:.4,orientation:"horizontal"},scales:{xAxes:[{ticks:{min:-1,max:1}}],yAxes:[{ticks:{min:-1,max:1}}]}}),e.defaults.global.datasets&&e.defaults.global.datasets.graph&&(e.defaults.global.datasets.dendogram=a({},e.defaults.global.datasets.graph));var Dt=h.prototype,Nt=e.controllers.dendogram=h.extend({updateEdgeElement:function(t,n){Dt.updateEdgeElement.call(this,t,n),t._orientation=this.chart.options.tree.orientation;var r=this.chart.options;t._model.tension=e.helpers.valueOrDefault(this.getDataset().lineTension,r.tree.lineTension,r.elements.line.lineTension)},updateElement:function(t,e,n){Dt.updateElement.call(this,t,e,n);var r=this.getDataset().data[e];t._model.angle=r.angle},resyncLayout:function(){var t=this,e=this.getMeta();e.root=ft(this.getTreeRoot(),function(e){return t.getTreeChildren(e)}).count().sort(function(t,e){return e.height-t.height||e.data.index-t.data.index}),this.doLayout(e.root),Dt.resyncLayout.call(this)},reLayout:function(){this.doLayout(this.getMeta().root)},doLayout:function(t){var e=this,n=this.chart.options.tree,r="tree"===n.mode?Et():ht();"radial"===n.orientation?r.size([2*Math.PI,1]):r.size([2,2]);var i={horizontal:function(t){t.data.x=t.y-1,t.data.y=1-t.x},vertical:function(t){t.data.x=t.x-1,t.data.y=1-t.y},radial:function(t){t.data.x=Math.cos(t.x)*t.y,t.data.y=Math.sin(t.x)*t.y,t.data.angle=0===t.y?NaN:t.x}};r(t).each(i[n.orientation]||i.horizontal),requestAnimationFrame(function(){return e.chart.update()})}});e.defaults.tree=e.helpers.merge({},[e.defaults.dendogram,{tree:{mode:"tree"}}]);var At=e.controllers.tree=Nt;t.Dendogram=Nt,t.EdgeLine=o,t.ForceDirectedGraph=ot,t.Graph=h,t.Tree=At,Object.defineProperty(t,"__esModule",{value:!0})});